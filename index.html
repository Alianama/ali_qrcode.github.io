<!DOCTYPE html>

<html>
  <head>
    <meta charset="UTF-8" />

    <title>QR Generator</title>

    <script
      type="text/javascript"
      src="https://unpkg.com/qr-code-styling/lib/qr-code-styling.js"
    ></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <!--This is the result file of an Article I wrote on Medium.com -->
    <!--You can read it at: https://medium.com/@facucarbonel_97514/how-to-create-a-qr-generator-using-javascript-4b5ce1b6ec27 -->

    <header id="header"><h1>QR Code Generator</h1></header>

    <section id="content">
      <div>
        <form id="qrForm" onsubmit="return false;">
          <div class="inputContainer">
            <label for="dataInput">Data</label>

            <input
              type="text"
              onchange="updateQrData();"
              name="dataInput"
              id="dataInput"
              placeholder="Masukan Link"
              required
            />
          </div>

          <div class="inputContainer">
            <label for="imageInput">Image</label>

            <input
              type="file"
              onchange="updateQrImg();"
              name="imageInput"
              id="imageInput"
              accept="image/*"
            />
          </div>

          <div class="inputContainer">
            <label for="colorInput">Color</label>

            <input
              type="color"
              onchange="updateQrColor();"
              name="colorInput"
              id="colorInput"
            />
          </div>

          <div class="inputContainer">
            <label for="typeInput">Type</label>

            <select name="typeInput" id="typeInput" onchange="updateQrType();">
              <option value="square">Square</option>

              <option value="rounded">Rounded</option>

              <option value="dots">Dots</option>
            </select>
          </div>
        </form>

        <button id="formButton" onclick="download();">Download</button>
      </div>

      <div id="canvas"></div>
    </section>
    <script type="text/javascript">
      var qrData = document.getElementById("dataInput");
      var qrImage = document.getElementById("imageInput");
      var qrColor = document.getElementById("colorInput");
      var qrType = document.getElementById("typeInput");

      const qrCode = new QRCodeStyling({
        width: 300,
        height: 300,
        data: "H7a8b9c",
        image: "",
        dotsOptions: {
          color: "#000",
          type: "square",
        },
      });

      const updateQrData = () => {
        var newQrData = qrData.value;
        qrCode.update({
          data: newQrData,
        });
      };

      const updateQrImg = () => {
        var newQrImage = URL.createObjectURL(qrImage.files[0]);
        console.log(newQrImage);
        qrCode.update({
          image: newQrImage,
        });
      };

      const updateQrColor = () => {
        var newQrColor = qrColor.value;
        qrCode.update({
          dotsOptions: {
            color: newQrColor,
          },
        });
      };

      const updateQrType = () => {
        var newQrType = qrType.value;
        qrCode.update({
          dotsOptions: {
            type: newQrType,
          },
        });
      };

      const download = () => qrCode.download("jpeg");

      qrCode.append(document.getElementById("canvas"));
    </script>
  </body>
</html>
